X <- c(65,63,67,64,68,62,70,66,68,67,62,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=mean(x)
x_barre=mean(x)
X <- c(65,63,67,64,68,62,70,66,68,67,62,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=mean(x)
x <- c(65,63,67,64,68,62,70,66,68,67,62,71)
x_barre=mean(x)
n=length(x)
x_carré=x^2
var_x=1/n*(sum(x_carré)-x_barre)
var_x
x_barre=1/n*sum(x)
x_barre
var_x=1/n*(sum(x^2)-x_barre)
var_x
plot(x,y)
plot(x,y)
var_x=1/n*(sum(x^2))-x_barre
var_x
x_barre
var_x=1/n*(sum(x^2))-x_barre
var_x
x_barre=1/n*sum(x)
x_barre
n=length(x)
var_x=1/n*(sum(x^2))-x_barre
var_x
var_x=1/n*(sum(x^2))-x_barre^2
var_x
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
n=length(x)
var_x=1/n*(sum(x^2))-x_barre^2
var_x
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
plot(x,y)
a=cov/var_x
a=cov/var_x;a
y_barre=1/n*sum(y)
b=var_x
b=var_x;b
plot(x,y)
plot(x,y)
plot(x,y)
b=var_x-a*x_barre
plot(x,y)
plot(x,y)
plot(x,y)
plot(x,y)
plot(x,y)
abline(a,b)
abline(a,b,add=TRUE)
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
abline(model, col = "red", lwd = 2)
plot(x,y)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
y_barre=1/n*sum(y)
n=length(x)
#1.
var_x=1/n*(sum(x^2))-x_barre^2
var_x
#2.
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
a=cov/var_x;a
b=var_x;b
#3.
a=cov/var_x;a
b=var_x-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum(y-a*x-b)^2
#5
#
sum((y-a*x-b)^2)
#5
#
sum((y-a*x-b)^2)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
#5
#
sum((y-a*x-b)^2)
#5
#
sum((y-a*x-b)**2)
a=cov/var_x;a
b=var_x;b
b=y_barre-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum((y-a*x-b)2)
#5
#
sum((y-a*x-b)^2)
plot(x,y)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
y_barre=1/n*sum(y)
n=length(x)
#1.
var_x=1/n*(sum(x^2))-x_barre^2
var_x
#2.
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
a=cov/var_x;a
#3.
a=cov/var_x;a
b=y_barre-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum((y-a*x-b)^2)
plot(x,y)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
y_barre=1/n*sum(y)
n=length(x)
#1.
var_x=1/n*(sum(x^2))-x_barre^2
var_x
#2.
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
a=cov/var_x;a
#3.
a=cov/var_x;a
b=y_barre-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum((y-a*x-b)^2)
plot(x,y)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
y_barre=1/n*sum(y)
n=length(x)
#1.
var_x=1/n*(sum(x^2))-x_barre^2
var_x
#2.
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
a=cov/var_x;a
#3.
a=cov/var_x;a
b=y_barre-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum((y-a*x-b)^2)
plot(x,y)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
y_barre=1/n*sum(y)
n=length(x)
#1.
var_x=1/n*(sum(x^2))-x_barre^2
var_x
#2.
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
a=cov/var_x;a
#3.
a=cov/var_x;a
b=y_barre-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum((y-a*x-b)^2)
plot(x,y)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
y_barre=1/n*sum(y)
n=length(x)
#1.
var_x=1/n*(sum(x^2))-x_barre^2
var_x
#2.
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
a=cov/var_x;a
#3.
a=cov/var_x;a
b=y_barre-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum((y-a*x-b)^2)
plot(x,y)
x <- c(65,63,67,64,68,62,70,66,68,67,69,71)
y <- c(68,66,68,65,69,66,68,65,71,67,68,70)
x_barre=1/n*sum(x)
x_barre
y_barre=1/n*sum(y)
n=length(x)
#1.
var_x=1/n*(sum(x^2))-x_barre^2
var_x
#2.
cov=1/n*sum(x*y)-x_barre*mean(y)
cov
a=cov/var_x;a
#3.
a=cov/var_x;a
b=y_barre-a*x_barre
model <- lm(y ~ x)
abline(model, col = "red", lwd = 2)
#5
#
sum((y-a*x-b)^2)
#5
#
sum((y-a*x-b)^2)
nbviste_X=2,3,5,9,10,12,15
nbviste_X=c(2,3,5,9,10,12,15)
nbcommande_y=c(23,27,28,39,45,51)
moy=1/length(nbviste_X)*sum(nbviste_X)
var_=1/length(nbviste_X)*(sum(nbviste_X^2))-moy^2
var_
cov_=1/length(nbviste_X)sum(nbcommande_y*nbviste_X)-moy*mean(nbcommande_y)
cov_=1/length(nbviste_X)*sum(nbcommande_y*nbviste_X)-moy*mean(nbcommande_y)
cov_=1/length(nbviste_X)*sum(nbcommande_y*nbviste_X)-moy*mean(nbcommande_y)
nbcommande_y=c(23,27,28,39,39,45,51)
cov_=1/length(nbviste_X)*sum(nbcommande_y*nbviste_X)-moy*mean(nbcommande_y)
cov_
a=cov_/var_
aa=cov_/var_
bb=mean(nbcommande_y)-aa*moy
cov_=1/length(nbviste_X)*sum(nbcommande_y*nbviste_X)-moy*mean(nbcommande_y)
cov_
aa=cov_/var_
bb=mean(nbcommande_y)-aa*moy
residus=sum((nbcommande_y-aa*nbviste_X-bb))
residus
residus=sum((nbcommande_y-aa*nbviste_X-bb)^2)
residus
O3=c(115.4,76.8,113.8,81.6,115.4,125,83.6,75.2,136.8,102.8)
####
####exo ####
t12=c(23.8,16.3,27.2,7.1,25.1,27.5,19.4,19.8,32.2,20.7)
O3_X=c(115.4,76.8,113.8,81.6,115.4,125,83.6,75.2,136.8,102.8)
var__=1/length(o3_X)*(sum(o3_X^2))-mean(O3_X)^2
O3_X=c(115.4,76.8,113.8,81.6,115.4,125,83.6,75.2,136.8,102.8)
var__=1/length(o3_X)*(sum(o3_X^2))-mean(O3_X)^2
o3_X=c(115.4,76.8,113.8,81.6,115.4,125,83.6,75.2,136.8,102.8)
var__=1/length(o3_X)*(sum(o3_X^2))-mean(O3_X)^2
var__
var__=1/length(o3_X)*(sum(o3_X^2))-mean(o3_X)^2
var__
var__=1/length(o3_X)*(sum(o3_X^2))-mean(o3_X)^2
var__
####
####exo ####
t12=c(23.8,16.3,27.2,7.1,25.1,27.5,19.4,19.8,32.2,20.7)
o3_X=c(115.4,76.8,113.8,81.6,115.4,125,83.6,75.2,136.8,102.8)
var__=1/length(o3_X)*(sum(o3_X^2))-mean(o3_X)^2
var__
var_a=1/length(o3_X)*(sum(o3_X^2))-mean(o3_X)^2
var__
var_a
var_a=1/length(o3_X)*sum(o3_X^2)-mean(o3_X)^2
var_a
var_a=1/length(t12)*sum(t12^2)-mean(t12)^2
var_a
cov_xy=1/length(t12)*sum(t12*o3_X)-mean(t12)*mean(o3_X)
sum((o3_X-cov_xy/var_a*t12-mean(t12)+cov_xy/var_a*t12*mean(t12))^2)
na <- c(9,11,8);sa= <- c(9,19,60);nb <- c(10,12,8);sb <- c(8,20,70);nc <- c(7,13,6);sc <- (7.5,21,80)
na <- c(9,11,8);sa<- c(9,19,60);nb <- c(10,12,8);sb <- c(8,20,70);nc <- c(7,13,6);sc <- (7.5,21,80)
na <- c(9,11,8);sa<- c(9,19,60);nb <- c(10,12,8);sb <- c(8,20,70);nc <- c(7,13,6);sc <- c(7.5,21,80)
Sa_barre=mean(sa)
Sa_barre=mean(sa);sb_barre=mean(sb);sc_barre=mean(sc)
v_sa=mean(na^2)-Sa_barre^2
v_sa=mean(na^2)-Sa_barre^2
v_sb=mean(nb^2)-sb_barre^2
v_sc=mean(nc^2)-sc_barre^2
var_intra=1/na+nb+nc*(na*v_sa+nb*v_sb+nc*v_sc)
var_intra
v_sa
var_intra=1/(na+nb+nc)*(na*v_sa+nb*v_sb+nc*v_sc)
var_intra
var_intra=(1/(na+nb+nc))*(na*v_sa+nb*v_sb+nc*v_sc)
var_intra
n1=sum(na[1:3])
n1
n1=sum(na[1:3]);n2=sum(na[1:3]);n3=sum(na[1:3])
sa_barre=1/n1*sum(na)
sa_barre
sa_barre=1/n1*na
sa_barre
sa_barre=1/length(na)*sum(na)
sa_barre
Sa_barre
sa_barre=1/length(na)*sum(na);sb_barre=1/length(nb)*sum(nb);sc_barre=1/length(nc)*sum(nc)
v_sa=1/length(na)*(sum(na^2))-sa_barre^2
v_sa=1/length(na)*(sum(na^2))-sa_barre^2;v_sb=1/length(nb)*(sum(nb^2))-sb_barre^2;v_sc=1/length(nc)*(sum(nc^2))-sc_barre^2
var_intra=1/length(na)*(na*v_sa+nb*v_sb+nc*v_sc)
var_intra
var_intra=1/length(na)*(n1*v_sa+n2*v_sb+n3*v_sc)
var_intra
reg <- lm(SalePrice~Gr.Liv.Area,data=df)
cor(df$SalePrice,df$Gr.Liv.Area)
df <- read.csv2(file="simplifiedAmesHousing.csv",header = TRUE,sep=';',dec = '.',stringsAsFactors = TRUE)
df
plot(SalePrice~Gr.Liv.Area,data=df)
cor(df$SalePrice,df$Gr.Liv.Area)
reg <- lm(SalePrice~Gr.Liv.Area,data=df)
reg <- lm(SalePrice~Gr.Liv.Area,data=df)
plot(SalePrice~Gr.Liv.Area,data=df)
abline(reg,col="red")
predict(reg,newdata = data.frame(Gr.Liv.Area=c(1500,2300,3000)))
cbind("prix observés"=df$SalePrice,"Prédiction"=reg$fitted.values,"Résidus"=reg$residuals)
(RMSE <- sqrt(mean(reg$residuals^2)))
(MAE <- mean(abs(reg$residuals)))
par(mfrow=c(1,2))
plot(reg,1:2)
install.packages("car")
install.packages(c("lmtest","skedastic"))
library(car)
library(lmtest)
library(skedastic)
install.packages("car")
install.packages(c("lm","skedastic"))
library(car)
library(lm)
install.packages("car")
install.packages(c("lm","skedastic"))
library(car)
library(lmtest)
library(skedastic)
install.packages("car")
install.packages(c("lm","skedastic"))
library(car)
library(lmtest)
library(skedastic)
install.packages("factomineR")
y
?PCA
??PCA
install.packages("FactoMineR")
library(FactoMineR)
??PCA
??corplot
install.packages("corrplot")
setwd("~/BUT SD/SD2/Méthodes factorielles")
data <- read.csv2("temperat.csv",
header = true,
sep = ";",
dec=".",
row.names = 1)
data <- read.csv2("temperat.csv",
header = TRUE,
sep = ";",
dec="."
)
data <- read.csv2("temperat.csv",
header = TRUE,
sep = ";",
dec="."
)
data <- read.csv2("temperat.csv",
header = TRUE,
sep = ";",
dec=".",
row.names = 1,
fileEncoding = "UTF-8"
)
data
data <- read.csv2(file.choose(),
header = TRUE,
sep = ";",
dec=".",
row.names = 1,
fileEncoding = "UTF-8"
)
data
View(data)
data <- read.csv2(file.choose(),
header = TRUE,
sep = ";",
dec=".",
row.names = 1,
fileEncoding = "UTF-8"
)
summary(data)
data <- read.csv2(file.choose(),
header = TRUE,
sep = ";",
dec=".",
row.names = 1,
fileEncoding = "UTF-8",
stringsAsFactors = TRUE
)
summary(data)
#Corrélation 2 à 2
corrplot(data)
library(corrplot)
library(corrplot)
#Corrélation 2 à 2
corrplot(data)
#Corrélation 2 à 2
library(corrplot)
corrplot(data)
mat_cor <- cor(data)
mat_cor <- cor(data[,:1,16])
mat_cor <- cor(data[,1:16])
corrplot(mat_cor,method = "pie")
#PCA
??PCA
#PCA
#scale.unit = 1ACP normé
#ind.sup= individus supplémentaires les numéros 13 à 16
#quali.sup= var qualitative supplémentaires
res.pca=PCA(X=data,quanti.sup=13:16,quali.sup=17)
library(FactoMineR)
#PCA
#scale.unit = 1ACP normé
#ind.sup= individus supplémentaires les numéros 13 à 16
#quali.sup= var qualitative supplémentaires
library(FactoMineR)
res.pca=PCA(X=data,quanti.sup=13:16,quali.sup=17)
res.pca
res.pca=PCA(X=data,quanti.sup=13:16,quali.sup=17)
res.pca
